(this.webpackJsonpchathackathon2021=this.webpackJsonpchathackathon2021||[]).push([[0],{350:function(e,t,a){},351:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a(26),n=a.n(s),r=a(3),i=a(10),l=a.n(i),o=a(18),u=a(5),j=a(22),d=a(23),m=a.n(d),h=a(2),b=function(e){var t=e.message;return t.attachments&&t.attachments.length>0?/(mp3|wav|ogg|webm|m4a)/.exec(t.attachments[0].file)?Object(h.jsx)("audio",{src:t.attachments[0].file,style:{float:"right"},controls:!0,children:"No Funciona el audio"}):Object(h.jsx)("img",{src:t.attachments[0].file,alt:"msj-adjunto",className:"msj-img",style:{float:"right"}}):Object(h.jsx)("div",{className:"msj",style:{float:"right",marginRight:"18px",color:"white",backgroundColor:"#014670"},children:t.text})},p=function(e){var t=e.lastMessage,a=e.message,c=!t||t.sender.username!==a.sender.username;return a.attachments&&a.attachments.length>0?/(jpg|gif|png|jpeg)/.exec(a.attachments[0].file)?Object(h.jsxs)("div",{className:"msj-row",children:[Object(h.jsx)("img",{src:a.attachments[0].file,alt:"msj-adjunto",className:"msj-img",style:{marginLeft:"4px"}}),Object(h.jsx)("div",{className:"msj",style:{float:"left",marginLeft:"4px"},children:"        "})]}):/(mp3|wav|ogg|webm|m4a)/.exec(a.attachments[0].file)?Object(h.jsxs)("div",{className:"msj-row",children:[Object(h.jsx)("audio",{src:a.attachments[0].file,style:{marginLeft:"4px"},controls:!0,children:"No Funciona el audio"}),Object(h.jsx)("div",{className:"msj",style:{float:"left",marginLeft:"4px"},children:"        "})]}):Object(h.jsxs)("div",{className:"msj-row",children:["ARCHIVO NO SOPORTADO",Object(h.jsx)("div",{className:"msj",style:{float:"left",marginLeft:"4px"},children:a.sender.username})]}):Object(h.jsx)("div",{className:"msj-row",children:Object(h.jsxs)("div",{children:[c&&Object(h.jsx)("div",{className:"msj-username",children:a.sender.username}),Object(h.jsx)("div",{className:"msj",style:{float:"left",backgroundColor:"#BFE6EF",marginLeft:"4px"},children:a.text})]})})},f=a(353),O=a(354),g=a(355),x=function(e){var t,a=Object(c.useState)(""),s=Object(u.a)(a,2),n=s[0],r=s[1],i=e.chatId,l=e.creds,o=[],d=function(e){"mousedown"===e.type?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){(t=new MediaRecorder(e)).addEventListener("dataavailable",(function(e){o.push(e.data)})),t.start()})):new Promise((function(e){t.addEventListener("stop",(function(){var t=new Blob(o,{type:"audio/wav"}),a=new File([t],"sound.wav",{type:t.type}),c=new DataTransfer;c.items.add(a);var s=c.files;Object(j.u)(l,i,{attachments:s,text:""}),e({audioBlob:t})})),t.stop()}))},m=function(e){e.preventDefault();var t=n.trim();t.length>0&&Object(j.u)(l,i,{text:t}),r("")};return Object(h.jsxs)("form",{className:"msj-form",onSubmit:m,children:[Object(h.jsx)("input",{className:"msj-input",placeholder:"Escribe tu mensaje aqu\xed...",value:n,onChange:function(t){r(t.target.value),Object(j.q)(e,i)},onSubmit:m}),Object(h.jsx)("label",{htmlFor:"upload-button",children:Object(h.jsx)("span",{className:"image-button",children:Object(h.jsx)(f.a,{className:"picture-icon"})})}),Object(h.jsx)("input",{type:"file",multiple:!1,accept:"image/*, audio/*",id:"upload-button",style:{display:"none"},onChange:function(e){Object(j.u)(l,i,{files:e.target.files,text:""}),console.log(e.target.files)}.bind(undefined)}),Object(h.jsx)("label",{htmlFor:"record",children:Object(h.jsx)("span",{className:"image-button",children:Object(h.jsx)(O.a,{id:"record",onMouseDown:d,onMouseUp:d,className:"picture-icon"})})}),Object(h.jsx)("button",{type:"submit",className:"send-button",children:Object(h.jsx)(g.a,{className:"send-icon"})})]})},v=function(e){var t=e.chats,a=e.activeChat,c=e.userName,s=e.messages,n=t&&t[a],i=function(e,t){return n.people.map((function(a,c){return a.last_read===e.id&&Object(h.jsx)("div",{className:"read-receipt",style:{float:t?"right":"left",backgroundImage:"url(".concat(a.person.avatar,")")}},"read_".concat(c))}))};return n?Object(h.jsxs)("div",{className:"chat-feed",children:[Object(h.jsxs)("div",{className:"chat-titulo-container",children:[Object(h.jsx)("div",{className:"chat-titulo",children:null===n||void 0===n?void 0:n.title}),Object(h.jsx)("div",{className:"chat-subtitulo",children:n.people.map((function(e){return" ".concat(e.person.username)}))})]}),function(){var e=Object.keys(s);return e.map((function(t,a){var n=s[t],r=0===a?null:e[a-1],l=c===n.sender.username;return Object(h.jsxs)("div",{style:{width:"100%"},children:[Object(h.jsx)("div",{className:"msj-block",children:l?Object(h.jsx)(b,{message:n}):Object(h.jsx)(p,{message:n,lastMessage:s[r]})}),Object(h.jsx)("div",{className:"read-receipts",style:{marginRight:l?"18px":"0px",marginLeft:l?"0px":"68px"},children:i(n,l)})]},"msg_".concat(a))}))}(),Object(h.jsx)("div",{style:{height:"100px"}}),Object(h.jsx)("div",{className:"msj-form-container",children:Object(h.jsx)(x,Object(r.a)(Object(r.a)({},e),{},{chatId:a}))})]}):Object(h.jsx)("div",{})},N="49b4a87e-d240-4bcd-8a01-b3adcf431810";function S(e){var t=e.value,a=void 0===t?0:t,s=Object(c.useState)(""),n=Object(u.a)(s,2),r=n[0],i=n[1],j=Object(c.useState)(""),d=Object(u.a)(j,2),b=d[0],p=d[1],f=Object(c.useState)(""),O=Object(u.a)(f,2),g=O[0],x=O[1],v=Object(c.useState)(a),S=Object(u.a)(v,2),y=S[0],I=S[1],C=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={"Project-ID":N,"User-Name":r,"User-Secret":b},e.prev=2,e.next=5,m.a.get("https://api.chatengine.io/chats",{headers:a});case 5:localStorage.setItem("username",r),localStorage.setItem("password",b),I(2),x(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),x("Usuario y contrase\xf1a incorrectos");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return 0===y?Object(h.jsx)("div",{className:"wrapper",children:Object(h.jsxs)("div",{className:"form",children:[Object(h.jsx)("h1",{className:"title",children:"XUBIO Chat"}),Object(h.jsxs)("form",{onSubmit:C,children:[Object(h.jsx)("input",{type:"text",value:r,onChange:function(e){return i(e.target.value)},className:"input",placeholder:"Nickname",required:!0}),Object(h.jsx)("input",{type:"password",value:b,onChange:function(e){return p(e.target.value)},className:"input",placeholder:"Password",required:!0}),Object(h.jsx)("div",{align:"center",children:Object(h.jsx)("button",{type:"submit",className:"button",children:Object(h.jsx)("span",{children:"Iniciar Sesion"})})})]}),Object(h.jsx)("div",{align:"center",children:Object(h.jsx)("button",{type:"button",className:"button",onClick:function(e){e.preventDefault(),I(1)},children:Object(h.jsx)("span",{children:"Registrate"})})}),Object(h.jsx)("h2",{className:"error",children:g})]})}):1===y?Object(h.jsx)(w,{}):2===y?Object(h.jsx)(D,{value:1}):void 0}function w(e){var t=e.value,a=void 0===t?0:t,s=Object(c.useState)(a),n=Object(u.a)(s,2),r=n[0],i=n[1],j=Object(c.useState)(""),d=Object(u.a)(j,2),b=d[0],p=d[1],f=Object(c.useState)(""),O=Object(u.a)(f,2),g=O[0],x=O[1],v=Object(c.useState)(""),w=Object(u.a)(v,2),y=w[0],I=w[1];function C(){return(C=Object(o.a)(l.a.mark((function e(t){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={"Project-ID":N,"User-Name":b,"User-Secret":g},e.prev=2,e.next=5,m.a.get("https://api.chatengine.io/users/me/",{headers:a});case 5:localStorage.setItem("username",b),localStorage.setItem("password",g),I("El usuario ingresado ya existe"),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),c={method:"put",url:"https://api.chatengine.io/users/",headers:{"PRIVATE-KEY":"480c381a-e095-4bac-9361-af4729e34fb6"},data:{username:b,secret:g}},m()(c).then((function(e){I("Registro Correcto")})).catch((function(e){I("Error del servidor")}));case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}return 0===r?Object(h.jsx)("div",{className:"wrapper",children:Object(h.jsxs)("div",{className:"form",children:[Object(h.jsx)("h1",{className:"title",children:"XUBIO Chat"}),Object(h.jsxs)("form",{onSubmit:function(e){return C.apply(this,arguments)},children:[Object(h.jsx)("input",{type:"text",value:b,onChange:function(e){return p(e.target.value)},className:"input",placeholder:"Nickname",required:!0}),Object(h.jsx)("input",{type:"password",value:g,onChange:function(e){return x(e.target.value)},className:"input",placeholder:"Password",required:!0}),Object(h.jsx)("div",{align:"center",children:Object(h.jsx)("button",{type:"submit",className:"button",children:Object(h.jsx)("span",{children:"Registrate"})})})]}),Object(h.jsx)("div",{align:"center",children:Object(h.jsx)("button",{type:"button",className:"button",onClick:function(e){e.preventDefault(),i(1)},children:Object(h.jsx)("span",{children:"Atras"})})}),Object(h.jsx)("h2",{className:"error",align:"center",children:y})]})}):1===r?Object(h.jsx)(S,{}):void 0}var y=S,I=(a(350),"49b4a87e-d240-4bcd-8a01-b3adcf431810");function C(){return""}function k(){var e,t=Object(c.useState)(""),a=Object(u.a)(t,2),s=a[0],n=a[1],r=Object(c.useState)("off"),i=Object(u.a)(r,2),j=i[0],d=i[1],b=[];return Object(h.jsx)("div",{align:"center",className:"chat-seccion",children:Object(h.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),"off"===j){var a={title:s.trim(),is_direct_chat:!1},c={method:"post",url:"https://api.chatengine.io/chats/",headers:{"Project-ID":I,"User-Name":localStorage.getItem("username"),"User-Secret":localStorage.getItem("password")},data:a};m()(c).then((function(e){console.log("creada")})).catch((function(e){console.log("error")}))}if("on"===j){var n={title:s.trim(),is_direct_chat:!1},r={method:"post",url:"https://api.chatengine.io/chats/",headers:{"Project-ID":I,"User-Name":localStorage.getItem("username"),"User-Secret":localStorage.getItem("password")},data:n};m()(r).then((function(t){var a={method:"get",url:"https://api.chatengine.io/chats/"+(e=t.data.id)+"/others/",headers:{"Project-ID":I,"User-Name":localStorage.getItem("username"),"User-Secret":localStorage.getItem("password")}};m()(a).then((function(t){t.data.forEach((function(e){b.push({username:e.username})})),b.forEach(function(){var t=Object(o.a)(l.a.mark((function t(a){var c,s,n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c="https://api.chatengine.io/chats/"+e+"/people/",s=a,n={"Project-ID":I,"User-Name":localStorage.getItem("username"),"User-Secret":localStorage.getItem("password")},r={method:"post",url:c,headers:n,data:s},t.next=6,m()(r).then((function(e){console.log("si")}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch()((function(e){console.log("error al crear la sala 2")}))})).catch((function(e){console.log("error al crear la sala 1")}))}},children:[Object(h.jsx)("input",{className:"sala-input",type:"text",placeholder:"Nombre sala...",value:s,onChange:function(e){n(e.target.value)}}),Object(h.jsx)("button",{className:"btn-crearsala",type:"submit",children:"Crear Sala +"}),Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"label-sala",children:[Object(h.jsx)("label",{className:"label-publica",htmlFor:"publica",children:"Sala Publica"}),Object(h.jsx)("input",{className:"input-publica",type:"checkbox",id:"publica",name:"publica",onChange:function(e){e.target.value===j?d("off"):d(e.target.value)}})]})]})})}var D=function(e){var t=e.value,a=void 0===t?0:t,s=Object(c.useState)(a),n=Object(u.a)(s,2),i=n[0],l=n[1];return 0===i?Object(h.jsx)(y,{}):1===i?Object(h.jsxs)("div",{className:"body",children:[Object(h.jsxs)("header",{className:"chat-header",children:[Object(h.jsx)("div",{className:"chat-logo",children:"XUBIO Chat"}),Object(h.jsx)("div",{height:"10vh",children:Object(h.jsx)("button",{className:"btn-logout",type:"button",onClick:function(e){e.preventDefault(),localStorage.setItem("username",null),localStorage.setItem("password",null),l(0)},children:"Cerrar Sesi\xf3n"})})]}),Object(h.jsx)("div",{children:Object(h.jsx)(j.d,{height:"90vh",projectID:I,userName:localStorage.getItem("username"),userSecret:localStorage.getItem("password"),renderChatFeed:function(e){return Object(h.jsx)(v,Object(r.a)({},e))},renderNewChatForm:function(e){return Object(h.jsx)(k,{creds:e})},renderPhotosSettings:function(e){return Object(h.jsx)(C,{chat:e})},renderScrollDownBar:function(e){return Object(h.jsx)(j.g,{chat:e})},onNewMessage:function(){return new Audio("https://chat-engine-assets.s3.amazonaws.com/click.mp3").play()}})})]}):void 0};n.a.render(Object(h.jsx)(D,{}),document.getElementById("root"))}},[[351,1,2]]]);
//# sourceMappingURL=main.7fc6a467.chunk.js.map